(this["webpackJsonpCapstone2-frontend"]=this["webpackJsonpCapstone2-frontend"]||[]).push([[0],{176:function(e,t,a){e.exports=a(337)},181:function(e,t,a){},200:function(e,t,a){},208:function(e,t,a){},209:function(e,t,a){},210:function(e,t,a){},211:function(e,t,a){},212:function(e,t,a){},213:function(e,t,a){},214:function(e,t,a){},215:function(e,t,a){},216:function(e,t,a){},222:function(e,t){},224:function(e,t){},238:function(e,t){},240:function(e,t){},268:function(e,t){},270:function(e,t){},271:function(e,t){},276:function(e,t){},278:function(e,t){},284:function(e,t){},286:function(e,t){},305:function(e,t){},317:function(e,t){},320:function(e,t){},337:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(24),l=a.n(r),s=(a(181),a(182),a(342)),o=a(175),m=a(345),i=a(346),u=a(9),d=a(64),g=a.n(d);const E=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BASE_URL||"http://localhost:3001";class p{static async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get";const n="".concat(E,"/").concat(e),c={Authorization:"Bearer ".concat(p.token)},r="get"===a?t:{};try{return(await g()({url:n,method:a,data:t,params:r,headers:c})).data}catch(l){console.error("JustRealFood API Error:",l.response);let e=l.response.data.error.message;throw Array.isArray(e)?e:[e]}}static async getCurrentUser(e){return(await this.request("api/users/".concat(e))).user}static async getAllProducts(e){return(await this.request("api/products",{name:e})).products}static async getProductByName(e){return(await this.request("api/products/name/".concat(e))).products}static async getProductByCategory(e){return(await this.request("api/products/category/".concat(e))).products}static async signup(e){return(await this.request("api/auth/user/register",e,"post")).token}static async login(e){return(await this.request("api/auth/user/token",e,"post")).token}}var h=p;const f=Object(n.createContext)({items:[],getProductQuantity:()=>{},addOneItemToCart:()=>{},removeOneItemFromCart:()=>{},deleteFromCart:()=>{},getTotalCost:async()=>{},getProductData:async()=>{}});var v=function(e){let{children:t}=e;const[a,r]=Object(n.useState)([]);async function l(e){let t=(await h.getAllProducts()).find(t=>t.id===e);if(void 0!==t)return t;console.log("Product data does not exist for ID: "+e)}function s(e){var t;const n=null===(t=a.find(t=>t.id===e))||void 0===t?void 0:t.quantity;return void 0===n?0:n}function o(e){r(t=>t.filter(t=>t.id!==e))}const m={items:a,getProductQuantity:s,addOneItemToCart:async function(e){const t=s(e),n=await l(e);r(0===t?[...a,{id:e,name:n.name,price:n.price,quantity:1}]:a.map(t=>t.id===e?{...t,quantity:t.quantity+1}:t))},removeOneItemFromCart:function(e){1===s(e)?o(e):r(a.map(t=>t.id===e?{...t,quantity:t.quantity-1}:t))},deleteFromCart:o,getTotalCost:async function(){let e=0;const t=a.map(async t=>{const a=await l(t.id);e+=a.price*t.quantity});return await Promise.all(t),e},getProductData:l};return c.a.createElement(f.Provider,{value:m},t)};var y=function(e){let{id:t,quantity:a}=e;const r=Object(n.useContext)(f),[l,s]=Object(n.useState)([]);return Object(n.useEffect)(()=>{r.getProductData(t).then(e=>{s(e)})},[r,t]),c.a.createElement(c.a.Fragment,null,c.a.createElement("h3",null,l.name),c.a.createElement("p",null,a," total"),c.a.createElement("p",null,"$",(a*l.price).toFixed(2)),c.a.createElement(o.a,{variant:"danger",size:"sm",onClick:()=>r.deleteFromCart(t)},"Remove"),c.a.createElement("hr",null))};const N=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BASE_URL||"http://localhost:3001";var b=class{static async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get";const n="".concat(N,"/").concat(e),c="get"===a?t:{};try{return(await g()({url:n,method:a,data:t,params:c})).data}catch(r){console.error("Stripe API Error:",r.response);let e=r.response.data.error.message;throw Array.isArray(e)?e:[e]}}static async checkout(e,t){return(await this.request("api/stripe/checkout",{items:e,userId:t},"post")).url}};var C=c.a.createContext();a(200);var w=function(e){let{logout:t}=e;const a=Object(n.useContext)(f),{currentUser:r}=Object(n.useContext)(C),[l,d]=Object(n.useState)(0),[g,E]=Object(n.useState)(!1);Object(n.useEffect)(()=>{a.getTotalCost().then(e=>{d(e)})},[a]);const p=()=>E(!1),h=()=>E(!0),v=async()=>{let e=await b.checkout(a.items,r);console.log("THis is sessionUrl",e),window.location.assign(e)},N=a.items.reduce((e,t)=>e+t.quantity,0);function w(){return c.a.createElement(s.a,{className:"fixed-top",expand:"sm"},c.a.createElement(c.a.Fragment,null,c.a.createElement("ul",{className:"navbar-nav"},c.a.createElement("li",{className:"active"},c.a.createElement(u.c,{className:"nav-link",exact:!0,to:"/"},"Home")),c.a.createElement("li",{className:"active"},c.a.createElement(u.c,{className:"nav-link",exact:!0,to:"/api/products"},"All Products")),c.a.createElement("li",{className:"active"},c.a.createElement(u.c,{className:"nav-link",exact:!0,to:"/api/products/category/DogFood"},"Dog Food")),c.a.createElement("li",{className:"active"},c.a.createElement(u.c,{className:"nav-link",exact:!0,to:"/api/products/category/CatFood"},"Cat Food")),c.a.createElement("li",{className:"active"},c.a.createElement(o.a,{className:"cart-in-navbar",onClick:h},c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",className:"bi bi-cart",viewBox:"0 0 16 16"},c.a.createElement("path",{d:"M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l1.313 7h8.17l1.313-7zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"})),N)),c.a.createElement(u.c,{className:"logout-link",to:"/",onClick:t},"Log Out")),c.a.createElement(m.a,{show:g,onHide:p},c.a.createElement(m.a.Header,{closeButton:!0},c.a.createElement(m.a.Title,null,"Shopping Cart")),c.a.createElement(m.a.Body,null,N>0?c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,"Items in your cart:"),a.items.map((e,t)=>c.a.createElement(y,{key:t,id:e.id,quantity:e.quantity})),c.a.createElement("h1",null,"Total: $",l.toFixed(2)),c.a.createElement("button",{className:"cart-checkout",onClick:v},"Proceed to Checkout")):c.a.createElement("h1",{className:"navbar-msg"},"There are no items in your cart!")))))}function x(){return c.a.createElement(s.a,{className:"fixed-top",expand:"sm"},c.a.createElement(c.a.Fragment,null,c.a.createElement("ul",{className:"navbar-nav"},c.a.createElement("li",{className:"active"},c.a.createElement(u.c,{className:"nav-link",exact:!0,to:"/"},"Home")),c.a.createElement("li",{className:"active"},c.a.createElement(u.c,{className:"nav-link",exact:!0,to:"/api/products"},"All Products")),c.a.createElement("li",{className:"active"},c.a.createElement(u.c,{className:"nav-link",exact:!0,to:"/api/products/category/DogFood"},"Dog Food")),c.a.createElement("li",{className:"active"},c.a.createElement(u.c,{className:"nav-link",exact:!0,to:"/api/products/category/CatFood"},"Cat Food")),c.a.createElement("li",{className:"active"},c.a.createElement(u.c,{className:"nav-link",exact:!0,to:"/signup"},"Sign In")))))}return c.a.createElement(i.a,{className:"navbar navbar-expand-md"},r?c.a.createElement(w,null):c.a.createElement(x,null))},x=a(341),O=a(11);a(208),a(209);var k=function(){return c.a.createElement("div",{className:"Homepage"},c.a.createElement("div",{className:"homepage-container"},c.a.createElement("h1",{className:"homepage-title"},"Just Real Food for Dogs and Cats"),c.a.createElement("div",{className:"homepage-image",style:{backgroundImage:"url(/images/healthyfoods2.jpg)",backgroundRepeat:"no-repeat",backgroundSize:"contain",marginLeft:"100px",height:"600px",width:"100%"}})))};var S=function(e){let{type:t="danger",messages:a=[]}=e;return c.a.createElement("div",{className:"alert alert-".concat(t),role:"alert"},a.map(e=>c.a.createElement("p",{className:"alert-msg",key:e},e)))};a(210),a(211);var P=function(e){let{signup:t,login:a}=e;const[r,l]=Object(n.useState)({email:"",password:""}),[s,o]=Object(n.useState)({email:"",password:""}),[m,i]=Object(n.useState)([]),[u,d]=Object(n.useState)([]),g=Object(O.g)(),E=e=>{const{name:t,value:a}=e.target;l(e=>({...e,[t]:a}))},p=e=>{const{name:t,value:a}=e.target;o(e=>({...e,[t]:a}))};return c.a.createElement("div",{className:"Forms"},c.a.createElement("div",{className:"register"},c.a.createElement("h1",{className:"register-header"}," Register"),c.a.createElement("form",{onSubmit:async function(e){e.preventDefault();let a=await t(r);a.success?g.push("/"):i(a.errors)}},c.a.createElement("div",null,c.a.createElement("label",{className:"register-label",htmlFor:"email"},"Email"),c.a.createElement("input",{id:"register-email",type:"text",name:"email",value:r.email,onChange:E,style:{width:"500px",height:"30px"}})),c.a.createElement("div",null,c.a.createElement("label",{className:"register-label",htmlFor:"password"},"Password"),c.a.createElement("input",{id:"register-password",type:"password",name:"password",autoComplete:"on",value:r.password,onChange:E,style:{width:"500px",height:"30px"}})),m.length?c.a.createElement(S,{className:"loginFormError",type:"danger",messages:m}):null,c.a.createElement("button",{className:"register-btn"},"Register"))),c.a.createElement("div",{className:"login"},c.a.createElement("h1",{className:"login-header"}," Login"),c.a.createElement("form",{onSubmit:async function(e){e.preventDefault();let t=await a(s);t.success?g.push("/"):d(t.errors)}},c.a.createElement("div",null,c.a.createElement("label",{className:"login-label",htmlFor:"email"},"Email"),c.a.createElement("input",{id:"login-email",type:"text",name:"email",value:s.email,onChange:p,style:{width:"500px",height:"30px"}})),c.a.createElement("div",null,c.a.createElement("label",{className:"login-label",htmlFor:"password"},"Password"),c.a.createElement("input",{id:"login-password",type:"password",name:"password",autoComplete:"on",value:s.password,onChange:p,style:{width:"500px",height:"30px"}})),u.length?c.a.createElement(S,{type:"danger",messages:u}):null,c.a.createElement("button",{className:"login-btn"},"Login"))))},_=a(340),F=a(173);a(212);var T=function(e){let{product:t}=e;return c.a.createElement("div",{className:"products"},c.a.createElement(u.b,{className:"products-link",to:"/api/products/name/".concat(t.name)},c.a.createElement("h3",{className:"product-name"},t.name),c.a.createElement("h5",{className:"product-image"},t.image_url1&&c.a.createElement("img",{className:"product-image",src:t.image_url1,alt:t.name,style:{width:"250px",height:"300px"}}))))};a(213);var j=function(){return c.a.createElement("div",{className:"LoadingSpinner"},"Loading ...")};var D=function(){const[e,t]=Object(n.useState)([]);return Object(n.useEffect)((function(){!async function(){let e=await h.getAllProducts();t(e)}()}),[]),e?c.a.createElement(c.a.Fragment,null,c.a.createElement("h1",{align:"center",className:"ProductList-title"},"All Dog and Cat Recipes"),e.length?c.a.createElement(_.a,{xs:1,md:3,className:"g-4"},e.map((e,t)=>c.a.createElement(F.a,{align:"center",key:t},c.a.createElement(T,{product:e})))):c.a.createElement("p",{className:"lead"},"Sorry, no results were found!")):c.a.createElement(j,null)};var I=function(){const[e,t]=Object(n.useState)([]),{category:a}=Object(O.h)();return Object(n.useEffect)(()=>{!async function(){let e=await h.getProductByCategory(a);t(e)}()},[a]),e?c.a.createElement(c.a.Fragment,null,c.a.createElement("h1",{align:"center",className:"category-title"},a," Recipes"),e.length?c.a.createElement(_.a,{xs:1,md:3,className:"category-row"},e.map((e,t)=>c.a.createElement(F.a,{align:"center",key:t},c.a.createElement(T,{product:e}))),"DogFood"===a?c.a.createElement(u.b,{className:"category-dog-return-link",exact:!0,to:"/api/products"},"Return to All Products Page"):c.a.createElement(u.b,{className:"category-cat-return-link",exact:!0,to:"/api/products"},"Return to All Products Page")):c.a.createElement("p",{className:"lead"},"Sorry, no results were found!")):c.a.createElement(j,null)},A=a(344),R=a(343);a(214);var q=function(){const{name:e}=Object(O.h)(),{currentUser:t}=Object(n.useContext)(C),a=Object(n.useContext)(f),[r,l]=Object(n.useState)({id:"",name:"",ingredients:"",calorie_count:" ",category:" ",price:" "});Object(n.useEffect)(()=>{(async function(){return(await h.getProductByName(e))[0]})().then(e=>{l(e)})},[e]);const s=a.getProductQuantity(r.id);return c.a.createElement(A.a,{align:"right",style:{width:"800px",height:"650px"}},c.a.createElement(A.a.Body,null,s>0&&t?c.a.createElement(c.a.Fragment,null,c.a.createElement(R.a,{as:_.a},s>1?c.a.createElement(R.a.Label,{column:"true",sm:"6"},"In Cart: ",s," items"):c.a.createElement(R.a.Label,{column:"true",sm:"6"},"In Cart: ",s," item"),c.a.createElement(F.a,{sm:"6"},c.a.createElement(A.a.Title,{className:"productDetails-cardTitle1",align:"center"},r.name," ",r.category," Details"),c.a.createElement(A.a.Text,{className:"productDetails-price2",align:"center"},"$",r.price),c.a.createElement("div",{className:"productDetail-buttons"},c.a.createElement(o.a,{onClick:()=>a.removeOneItemFromCart(r.id),className:"minus-btn"},"-"),c.a.createElement("div",{className:"productDetails-productQuantity"},s),c.a.createElement(o.a,{onClick:()=>a.addOneItemToCart(r.id),className:"plus-btn"},"+"),c.a.createElement(o.a,{onClick:()=>a.deleteFromCart(r.id),className:"remove-from-cart-btn"},"Remove from cart")))),r.image_url3?c.a.createElement(_.a,{className:"g-4"},c.a.createElement(F.a,null,c.a.createElement(A.a.Img,{className:"col-img2",src:r.image_url2})),c.a.createElement(F.a,null,c.a.createElement(A.a.Img,{className:"col-img3",src:r.image_url3}))):c.a.createElement(_.a,{className:"g-4"},c.a.createElement(F.a,null,c.a.createElement(A.a.Img,{src:r.image_url2})))):0===s&&t?c.a.createElement(c.a.Fragment,null,c.a.createElement(o.a,{className:"addToCart-btn",onClick:()=>a.addOneItemToCart(r.id)},"Add to Cart"),c.a.createElement(A.a.Title,{className:"productDetails-cardTitle2",align:"center"},r.name," ",r.category," Details"),c.a.createElement(A.a.Text,{className:"productDetails-price",align:"center"},"$",r.price),r.image_url3?c.a.createElement(_.a,{className:"g-4"},c.a.createElement(F.a,null,c.a.createElement(A.a.Img,{src:r.image_url2})),c.a.createElement(F.a,null,c.a.createElement(A.a.Img,{src:r.image_url3}))):c.a.createElement(_.a,{className:"g-4"},c.a.createElement(F.a,null,c.a.createElement(A.a.Img,{src:r.image_url2})))):c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a.Title,{className:"productDetails-cardTitle2",align:"center"},r.name," ",r.category," Details"),c.a.createElement(A.a.Text,{className:"productDetails-price",align:"center"},"$",r.price),r.image_url3?c.a.createElement(_.a,{className:"g-4"},c.a.createElement(F.a,null,c.a.createElement(A.a.Img,{src:r.image_url2})),c.a.createElement(F.a,null,c.a.createElement(A.a.Img,{src:r.image_url3}))):c.a.createElement(_.a,{className:"g-4"},c.a.createElement(F.a,null,c.a.createElement(A.a.Img,{src:r.image_url2})))),c.a.createElement(u.b,{className:"ProductDetail-return-link",to:"/api/products"},"Return to All Products Page")))};a(215);var H=function(){return c.a.createElement("h1",{className:"cancel-h1"},"Your Stripe payment was cancelled!")};a(216);var L=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("h1",{className:"success-h1"},"Success!!"),c.a.createElement("img",{src:"/images/checkmark-icon.png",alt:"",className:"success-img"}),c.a.createElement("h2",{className:"success-h2"},"Thank you for your purchase!"))};var U=function(e){let{exact:t,path:a,children:r}=e;const{currentUser:l,isRequestCompleted:s}=Object(n.useContext)(C);return!l&&s?c.a.createElement(O.a,{to:"/signup"}):c.a.createElement(O.b,{exact:t,path:a},r)};var B=function(e){let{signup:t,login:a}=e;return c.a.createElement("div",{className:"Routes"},c.a.createElement(O.d,null,c.a.createElement(O.b,{exact:!0,path:"/"},c.a.createElement(k,null)),c.a.createElement(O.b,{exact:!0,path:"/signup"},c.a.createElement(P,{signup:t,login:a})),c.a.createElement(O.b,{exact:!0,path:"/api/products"},c.a.createElement(D,null)),c.a.createElement(O.b,{exact:!0,path:"/api/products/name/:name"},c.a.createElement(q,null)),c.a.createElement(O.b,{exact:!0,path:"/api/products/category/:category"},c.a.createElement(I,null)),c.a.createElement(U,{exact:!0,path:"/success"},c.a.createElement(L,null)),c.a.createElement(U,{exact:!0,path:"/cancel"},c.a.createElement(H,null)),c.a.createElement(O.b,null,c.a.createElement("div",null,c.a.createElement("p",{className:"errorHandler1"},"Hmmm. I can't seem to find what you want."),c.a.createElement("p",{className:"errorHandler2"},"Please click on one of the links above.")))))},K=a(174),W=a.n(K);var $=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=localStorage.getItem(e)||t,[c,r]=Object(n.useState)(a);return Object(n.useEffect)((function(){null===c?localStorage.removeItem(e):localStorage.setItem(e,c)}),[e,c]),[c,r]};var z=function(){const[e,t]=Object(n.useState)(!1),[a,r]=Object(n.useState)(null),[l,s]=$(""),[o,m]=Object(n.useState)(!1);return Object(n.useEffect)((function(){t(!1),async function(){if(l)try{let{email:e}=W.a.decode(l);h.token=l;let t=await h.getCurrentUser(e);r(t),m(!0)}catch(e){console.error("App loadUserInfo: problem loading",e),r(null)}t(!0)}()}),[l]),e?c.a.createElement(u.a,null,c.a.createElement(C.Provider,{value:{currentUser:a,setCurrentUser:r,isRequestCompleted:o}},c.a.createElement(v,null,c.a.createElement(x.a,null,c.a.createElement(w,{logout:function(){r(null),s(null)}}),c.a.createElement(B,{login:async function(e){try{let t=await h.login(e);return s(t),{success:!0}}catch(t){return console.error("login failed",t),{success:!1,errors:t}}},signup:async function(e){try{let t=await h.signup(e);return s(t),{success:!0}}catch(t){return console.error("signup failed",t),{success:!1,errors:t}}}}))))):c.a.createElement(j,null)};l.a.render(c.a.createElement(z,null),document.getElementById("root"))}},[[176,1,2]]]);
//# sourceMappingURL=main.ef0c4dfa.chunk.js.map